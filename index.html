<html>
	<head>
		<style>
			html, body{ margin:0; padding:0;} 
		</style>
		<script src='./three.js'></script>
		<script src='//rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js'></script>
	</head>
	<body>

		<script>

				var scene = new THREE.Scene(),
					renderer = new THREE.WebGLRenderer({antialias:true}),
					camera = new THREE.PerspectiveCamera( 110, 1.2, 0.1, 10000000 )


					controls = new THREE.OrbitControls( camera )

				document.body.appendChild( renderer.domElement )

				console.log( 'NEW')

				new THREE.JSONLoader().load( './htc_shaderTest_008.json', function( geometry, materials ){
				// new THREE.ColladaLoader().load( './dae-export.dae', function( geometry, materials ){


					console.log( geometry )

					var clock = new THREE.Clock()
					
					camera.position.z = 30



					scene.add( new THREE.DirectionalLight() )

					var material = new THREE.MeshLambertMaterial({wireframe:false, side:THREE.DoubleSide })
					material.skinning = true;
					// material.morphTargets = true;

					// geometry.scale( 30, 30, 30 )
					// geometry.center()


					var mesh = new THREE.SkinnedMesh( geometry, material )
					mesh.frustumCulled = false

					// mesh.scale.set( 0.1, 0.1, 0.1 )
					
					// var mixer = new THREE.AnimationMixer( mesh );
					var animations = []


					helper = new THREE.SkeletonHelper( mesh );
					helper.material.linewidth = 3;
					helper.visible = true;
					scene.add( helper );

					// mesh.scale.set( 1000, 1000, 1000 )
					console.log( helper )



					// Create the animations		
					// for ( var i = 0; i < geometry.animations.length; ++ i ) {
					// 	var animName = geometry.animations[ i ].name;
					// 	animations[ animName ] = geometry.animations[ i ];
					// }



					scene.add( mesh )
					mesh.rotation.y = Math.PI * -0.5
					// mesh.rotation.y = Math.PI * 0.5
					
					var animation = new THREE.Animation( mesh, geometry.animations[0] );
				animation.play();

					


					function render(){

						THREE.AnimationHandler.update( clock.getDelta() );
						helper.update();

						controls.update()
						// RENDER STEP - fbo's, post etc
						renderer.render( scene, camera )
						requestAnimationFrame( render )

					}

					


					function setSize( w, h ){

						camera.aspect = w / h;
						camera.updateProjectionMatrix();

						renderer.setSize( w, h )

					}

					setSize( window.innerWidth, window.innerHeight )
					document.addEventListener( 'reszie', function(){ setSize( window.innerWidth, window.innerHeight )})
					render()

				})

		</script>
	</body>
</html>